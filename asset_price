import pandas as pd

# load the daily OHLCV prices of 4 stocks
pko = pd.read_csv('/Users/Daniel/Downloads/pko_d.csv')
dnp = pd.read_csv('/Users/Daniel/Downloads/dnp_d.csv')
pgn = pd.read_csv('/Users/Daniel/Downloads/pgn_d.csv')
pkn = pd.read_csv('/Users/Daniel/Downloads/pkn_d.csv')

# prepare labels to drop
label = ['Otwarcie',
         'Najwyzszy',
         'Najnizszy',
         'Wolumen']

# drop labels
pko = pko.drop(label, axis = 1)
dnp = dnp.drop(label, axis = 1)
pgn = pgn.drop(label, axis = 1)
pkn = pkn.drop(label, axis = 1)

# add the rest of stocks closing prices to dnp variable. 
dnp["PGN"] = pgn["Zamkniecie"]

# change the datetime to mutual timespan across 4 stocks
dnp = dnp[dnp['Data'] >= '2017-11-10']
dnp = dnp.reset_index(drop=True)
dnp["PKO"] = pko["Zamkniecie"]
dnp["PKN"] = pkn["Zamkniecie"]

# rename columns 
dnp = dnp.rename(columns={"Zamkniecie": "DNP", "Data": "Date"})

# set the index to first column "Date"
asset_price = dnp.set_index(dnp.columns[0])

# check data by printing preprocessed stock prices
print(asset_price)

# save preprocessed stock prices to csv called "asset_price"
asset_price.to_csv("asset_price.csv")
